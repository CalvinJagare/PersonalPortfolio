const portfolioContent = {
    'portfolio': {
        'resume.pdf': {
            title: 'Resume',
            content: `RESUME - JOHN DOE
===================

PROFESSIONAL SUMMARY:
Senior Software Developer with 5+ years of experience in full-stack 
development, specializing in React, Node.js, and cloud technologies.

CORE COMPETENCIES:
â€¢ Full-Stack Development (React, Node.js, Python)
â€¢ Microservices Architecture
â€¢ Cloud Platforms (AWS, Azure)
â€¢ Database Design (SQL, NoSQL)
â€¢ DevOps & CI/CD
â€¢ Team Leadership & Mentoring

EDUCATION:
Bachelor of Science in Computer Science
University of Technology, 2018-2022

CERTIFICATIONS:
â€¢ AWS Certified Developer
â€¢ MongoDB Certified Developer
â€¢ React Developer Certification

ðŸ“„ DOWNLOAD RESUME: 
Click here to download the full PDF version:
https://your-resume-link.com/resume.pdf

Or view online: https://your-resume-link.com/resume`,
            pdfUrl: 'https://your-resume-link.com/resume.pdf'
        }
    },
    'about': {
        'about.txt': {
            title: 'About Me',
            content: `NAME: Calvin JÃ¤gare
LOCATION: LuleÃ¥, Sweden
EMAIL: cal.daniel.jagare@gmail.com
PHONE: +46 70 338 98 87

BIO:
Hi! I'm Calvin, a passionate and dedicated .NET system development student at YH Akademin. Programming has always been a strong personal interest of mine, and I've spent countless hours developing my skills independently. Now, through structured education, I'm building a deeper technical foundation and sharpening my approach to real-world development.

I'm driven, curious, and always eager to learn new technologies. Whether I'm working on backend systems, web applications, or refining existing solutions, I bring energy, precision, and a mindset focused on growth and quality.

EDUCATION:
â€¢ System Developer .NET
  YH Akademin, Aug 2024 â€“ May 2026 (Ongoing)
  Completed courses include:
    â€“ Object-Oriented Programming with C#
    â€“ Database Development
    â€“ Dynamic Web Applications
    â€“ Agile System Development
    â€“ Business Acumen
    â€“ Programming with C#.NET
    â€“ Test-Driven Development

â€¢ Police Academy
  UmeÃ¥ University, Aug 2021 â€“ May 2023

â€¢ Exercise and Nutrition Science
  UmeÃ¥ University, Aug 2023 â€“ May 2024

INTERESTS:
â€¢ Web and Software Development
â€¢ Continuous Learning and Personal Growth
â€¢ Fitness, Nutrition, and Photography
â€¢ Basketball and Sports`
        },
        'personal-statement.txt': {
            title: 'Personal Statement',
            content: `PERSONAL STATEMENT
====================

I believe that technology should be meaningful, something that improves lives, drives innovation, and contributes to a better society. As a .NET system development student with a deep personal interest in programming, I approach every project with curiosity, responsibility, and the goal of building practical, impactful software.

My technical experience spans C#, .NET, SQL, EF Core, and Azure, along with foundational knowledge in Python, Java, and Unity. I enjoy turning complex requirements into well-structured, maintainable code and have a growing interest in areas like cloud development, data visualization, and interactive technologies such as VR and game design.

Outside of my studies, I'm constantly learning, whether by exploring new frameworks, diving into side projects, or researching emerging technologies. I thrive in environments where I'm encouraged to experiment, collaborate, and build things that matter.

I'm motivated by real-world challenges, and I'm excited about opportunities where I can both contribute and grow as a developer, especially in settings that combine creativity, technology, and long-term societal value.`
        }
    },
    'projects': {
        'property-platform.txt': {
            title: 'Property Platform',
            content: `BROPERTYBROS PLATFORM
====================

TECHNOLOGY STACK:
â€¢ Frontend: Blazor WebAssembly
â€¢ Backend: ASP.NET Core Web API
â€¢ Database: Azure SQL
â€¢ Authentication: Role-based access
â€¢ Hosting: Azure

FEATURES:
â€¢ Public-facing portal for browsing property listings
â€¢ Realtor portal for posting new listings and managing firm details
â€¢ Admin panel for realtor/user management
â€¢ Super admin controls for full system oversight
â€¢ Fully responsive UI
â€¢ Secure login system with role separation

PROJECT HIGHLIGHTS:
â€¢ Full-stack development with clean separation between API and client
â€¢ Developed both client (BropertyBrosClientApplication) and backend (BropertyBrosApi) from scratch
â€¢ Demonstrated structured role management and modular backend design
â€¢ Served as a simulated real-world product with layered permissions and functionality`
        },
        'board-game-calculator.txt': {
            title: 'Board Game Calculator',
            content: `BOARD GAME CALCULATOR
====================

TECHNOLOGY STACK:
â€¢ Mobile App: .NET MAUI 
â€¢ Backend: Local storage

FEATURES:
â€¢ In-app calculator for advanced board game rules
â€¢ State tracking for rounds, players, and scores
â€¢ Simple UI optimized for fast in-game use

PROJECT HIGHLIGHTS:
â€¢ Designed for personal board game use with reusability across games
â€¢ Emphasized UX for speed and clarity in social settings
â€¢ Hands-on practice with mobile interface patterns and state persistence`
        },
        'kpi-system.txt': {
            title: 'KPI System',
            content: `KPI SYSTEM
====================

TECHNOLOGY STACK:
â€¢ Backend: .NET Web API
â€¢ Automation: Power Automate
â€¢ Data Collection: Microsoft Forms
â€¢ Database: Azure SQL
â€¢ Visualization: Power BI
â€¢ Identity: Microsoft Entra

FEATURES:
â€¢ Structured API for ingesting and storing form submissions
â€¢ Automated data flow from Forms to SQL via Power Automate
â€¢ Comment and KPI linkage logic for enhanced reporting
â€¢ Power BI dashboards for internal stakeholders

PROJECT HIGHLIGHTS:
â€¢ Built and deployed independently at LTU via the eMaintenance group
â€¢ Delivered a functioning MVP with full documentation
â€¢ Integrated identity and access management via Microsoft Entra
â€¢ Built a scalable backend data structure for long-term use`
        },
        'flash-hack-forum.txt': {
            title: 'Flash Hack Forum',
            content: `FLASH HACK FORUM
====================

TECHNOLOGY STACK:
â€¢ Frontend: HTML/CSS/JavaScript 
â€¢ Backend: .NET / REST API
â€¢ Database: SQL-based system

FEATURES:
â€¢ Themed forum with user accounts and content categories
â€¢ Admin roles for moderation and content management
â€¢ Personal profile pages with customization

PROJECT HIGHLIGHTS:
â€¢ Built complete user auth system with tiered permissions
â€¢ Focused on forum usability and extensibility
â€¢ Created for fast-paced development during a time-limited sprint`
        },
        'face-detect.txt': {
            title: 'Face Detect',
            content: `FACE DETECT
====================

TECHNOLOGY STACK:
â€¢ Language: Python
â€¢ Libraries: Deepface (and others similar to it)

FEATURES:
â€¢ Real-time camera input for face tracking
â€¢ Age, expression, and identity detection
â€¢ Visual overlay feedback via webcam

PROJECT HIGHLIGHTS:
â€¢ Fun exploration of computer vision and face recognition
â€¢ Experimented with various pre-trained models
â€¢ Gained practical insights into real-time processing challenges`
        },
        'portfolio-file-explorer.txt': {
            title: 'Portfolio File Explorer',
            content: `PORTFOLIO FILE EXPLORER
====================

TECHNOLOGY STACK:
â€¢ Frontend: HTML, CSS (custom Windows XP theme)
â€¢ JavaScript: Dynamic file explorer logic
â€¢ PDF.js: Embedded PDF viewer
â€¢ Sound: Web Audio API for Windows sound effects

FEATURES:
â€¢ Windows XP-style file explorer interface
â€¢ Interactive folder navigation and modal file viewing
â€¢ Dynamic loading of text and PDF content
â€¢ Classic Windows sound effects and animations
â€¢ Responsive design for desktop and mobile

PROJECT HIGHLIGHTS:
â€¢ Designed and built as a personal portfolio with a nostalgic twist
â€¢ Integrated PDF viewer and sound effects for authentic experience
â€¢ Fully customizable folder/file structure and content
â€¢ Deployed as a static site for easy hosting`
        },
        'ai-bro-bott.txt': {
            title: 'AI-Bro Bott',
            content: `AI-BRO BOTT
====================

TECHNOLOGY STACK:
â€¢ Language: Python
â€¢ Libraries: OpenAI API, basic NLP libraries

FEATURES:
â€¢ Conversational chatbot with fratboy-style personality
â€¢ Handles casual prompts and slang with humorous output
â€¢ Runs in terminal or chat interface

PROJECT HIGHLIGHTS:
â€¢ Built as a creative experiment in personality-driven AI
â€¢ Tinkered with prompt engineering and tone consistency
â€¢ Reinforced understanding of chatbot behavior and limitations`
        }
    },
    'skills': {
        'technical-skills.txt': {
            title: 'Technical Skills',
            content: `TECHNICAL SKILLS
================

PROGRAMMING LANGUAGES:
â€¢ C# â€“ Advanced
â€¢ SQL â€“ Advanced
â€¢ JavaScript â€“ Intermediate
â€¢ Java â€“ Basic
â€¢ Python â€“ Basic

FRONTEND TECHNOLOGIES:
â€¢ Blazor â€“ Advanced
â€¢ HTML5/CSS3 â€“ Advanced
â€¢ Bootstrap â€“ Intermediate
â€¢ Tailwind CSS â€“ Basic

BACKEND & FRAMEWORKS:
â€¢ .NET / .NET Core â€“ Advanced
â€¢ ASP.NET â€“ Advanced
â€¢ Entity Framework Core â€“ Advanced
â€¢ RESTful APIs â€“ Intermediate

DATABASES:
â€¢ Microsoft SQL Server â€“ Advanced
â€¢ SQLite â€“ Intermediate
â€¢ PostgreSQL â€“ Basic

DEVOPS & TOOLS:
â€¢ Visual Studio / VS Code â€“ Advanced
â€¢ Azure â€“ Intermediate
â€¢ Power Automate â€“ Advanced
â€¢ Power BI â€“ Intermediate
â€¢ Git / GitHub â€“ Intermediate
â€¢ Docker â€“ Basic`
        },
        'soft-skills.txt': {
            title: 'Soft Skills',
            content: `SOFT SKILLS
============

LEADERSHIP & MANAGEMENT:
â€¢ Independent Decision-Making
â€¢ Taking Initiative in Problem Situations
â€¢ Responsibility & Accountability
â€¢ Service-Driven Prioritization
â€¢ Task Planning and Coordination

COMMUNICATION:
â€¢ Clear and Empathetic Communication
â€¢ Technical Support & Troubleshooting Dialogue
â€¢ Customer-Focused Explanations
â€¢ Cross-Team Coordination
â€¢ Professional Written and Verbal Skills

PROBLEM SOLVING:
â€¢ Analytical Troubleshooting 
â€¢ Solution-Oriented Thinking
â€¢ Ability to Handle Complex Inquiries
â€¢ Decision-Making Under Pressure
â€¢ Evaluating User Needs and Delivering Targeted Solutions

WORK ETHIC:
â€¢ Time and Task Management
â€¢ Adaptability Across Industries
â€¢ Stress-Resilience in Fast-Paced Roles
â€¢ Consistent Quality and Precision
â€¢ Commitment to Growth and Learning

INTERPERSONAL:
â€¢ Customer Relations and Service Mindset
â€¢ Professional and Friendly Front-Facing Communication
â€¢ Conflict Awareness and Empathy (supported by Police/Nutrition background)
â€¢ Team Collaboration
â€¢ Active Listening and Situational Awareness`
        }
    },
    'experience': {
        'intern-developer.txt': {
            title: 'Intern Developer â€“ Customer Portal',
            content: `INTERN DEVELOPER â€“ CUSTOMER PORTAL
===============================
Company: Snek
Duration: Starting Aug 2025
Location: Sweden (Remote/Hybrid)

ROLE & RESPONSIBILITIES:
â€¢ Building a customer-facing portal to support business operations
â€¢ Responsible for both backend and frontend development
â€¢ Collaborating closely with the business team to tailor solutions to real customer needs
â€¢ Contributing to design, architecture, and delivery of production-ready features

TECHNICAL GOALS:
â€¢ Leverage Blazor or modern web frameworks in real business context
â€¢ Implement secure authentication and customer management tools
â€¢ Deploy scalable backend services and integrate with internal APIs

GROWTH OPPORTUNITIES:
â€¢ Gain hands-on experience in building production systems
â€¢ Work closely with business stakeholders to align tech with strategy
â€¢ Expand understanding of SaaS product delivery in a startup context`
        },
        'solo-developer.txt': {
            title: 'Solo Developer â€“ KPI System',
            content: `SOLO DEVELOPER â€“ KPI SYSTEM
==========================
Company: LuleÃ¥ University of Technology (via eMaintenance Group)
Duration: Summer 2025
Location: LuleÃ¥, Sweden

ROLE & RESPONSIBILITIES:
â€¢ Independently developed a KPI tracking system to support research project reporting
â€¢ Built a backend API for structured form data ingestion using C# and .NET
â€¢ Integrated Microsoft Forms, Power Automate, and Azure SQL to automate and centralize data collection
â€¢ Enabled visualization and reporting through structured Power BI dashboards
â€¢ Worked with Microsoft Entra for secure identity management and access control

TECHNICAL ACHIEVEMENTS:
â€¢ Designed a normalized relational database schema in Azure SQL for scalable storage
â€¢ Developed robust Power Automate flows for form processing, data validation, and comment linking
â€¢ Integrated Microsoft Entra for authenticated access to internal systems
â€¢ Delivered a clean API endpoint structure tailored for automation and analysis

LEADERSHIP ACHIEVEMENTS:
â€¢ Managed the full development cycle independentlyâ€”from planning to deployment
â€¢ Created comprehensive internal documentation and user guides for future developers and analysts
â€¢ Aligned the system design with academic reporting needs and long-term maintainability
â€¢ Delivered a fully functional and production-ready MVP with stakeholder approval`
        },
        'technical-support-advisor.txt': {
            title: 'Technical Support Advisor',
            content: `TECHNICAL SUPPORT ADVISOR
=========================
Company: Telia
Duration: Jan 2019 â€“ Apr 2021
Location: Sweden

ROLE & RESPONSIBILITIES:
â€¢ Delivered technical support for broadband, TV, and mobile services
â€¢ Troubleshot hardware/software issues and guided customers through solutions
â€¢ Balanced multiple high-priority cases in a fast-paced environment
â€¢ Ensured positive customer experience through professional communication

TECHNICAL ACHIEVEMENTS:
â€¢ Refined issue-tracking workflows to improve support efficiency
â€¢ Built strong foundational knowledge in networking and telecom systems
â€¢ Maintained internal documentation for recurring support issues
â€¢ Achieved consistently high customer satisfaction metrics

LEADERSHIP ACHIEVEMENTS:
â€¢ Mentored junior team members and assisted in onboarding
â€¢ Took ownership of complex or escalated technical cases
â€¢ Demonstrated calm and clarity in high-pressure situations`
        }
    },
    'contact': {
        'contact-info.txt': {
            title: 'Contact Details',
            content: `CONTACT DETAILS
===============

EMAIL ADDRESSES:
â€¢ Primary: cal.daniel.jagare@gmail.com

PHONE NUMBERS:
â€¢ Mobile: +46 70 338 98 87

SOCIAL MEDIA:
â€¢ LinkedIn: www.linkedin.com/in/calvin-jÃ¤gare
â€¢ GitHub: @https://github.com/CalvinJagare 

LOCATION:
â€¢ City: LuleÃ¥
â€¢ Country: Sweden

AVAILABILITY:
â€¢ Open to new opportunities: Yes
â€¢ Remote work: Open
â€¢ Relocation: Open to discussion
â€¢ Contract work: Available

Letâ€™s connect and explore how I can bring value to your team or project!`
        }
    }
};

let soundsMuted = false;

const fileItems = document.querySelectorAll('.file-item');
const folderItems = document.querySelectorAll('.folder-item');
const modal = document.getElementById('fileModal');
const modalTitle = document.getElementById('modalTitle');
const modalBody = document.getElementById('modalBody');
const modalClose = document.getElementById('modalClose');
const titleBar = document.querySelector('.title-bar');
const closeButton = document.querySelector('.title-bar-button.close');

// File explorer functionality
let isDragging = false;
let currentX;
let currentY;
let initialX;
let initialY;
let xOffset = 0;
let yOffset = 0;

document.addEventListener('DOMContentLoaded', function() {
    initializeEventListeners();
    
    selectFolder('portfolio');
    
    updateStatusBar();
    updateTaskbarTime();
    setInterval(updateTaskbarTime, 1000);
});

function initializeEventListeners() {
    folderItems.forEach(item => {
        item.addEventListener('click', function() {
            const folderName = this.getAttribute('data-folder');
            if (window.windowsSounds && !soundsMuted) {
                window.windowsSounds.playClickSound();
            }
            selectFolder(folderName);
        });
    });

    modalClose.addEventListener('click', function() {
        if (window.windowsSounds && !soundsMuted) {
            window.windowsSounds.playModalCloseSound();
        }
        closeModal();
    });
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            if (window.windowsSounds && !soundsMuted) {
                window.windowsSounds.playModalCloseSound();
            }
            closeModal();
        }
    });

    titleBar.addEventListener('mousedown', startDragging);
    document.addEventListener('mousemove', drag);
    document.addEventListener('mouseup', stopDragging);

    closeButton.addEventListener('click', function() {
        if (window.windowsSounds && !soundsMuted) {
            window.windowsSounds.playClickSound();
        }
        if (confirm('Are you sure you want to close the Portfolio Explorer?')) {
            window.close();
        }
    });

    document.querySelectorAll('.menu-item').forEach(item => {
        item.addEventListener('click', function() {
            if (window.windowsSounds && !soundsMuted) {
                window.windowsSounds.playClickSound();
            }
            console.log('Menu clicked:', this.textContent);
        });
    });

    document.querySelectorAll('.toolbar-button').forEach(button => {
        button.addEventListener('click', function() {
            if (window.windowsSounds && !soundsMuted) {
                window.windowsSounds.playClickSound();
            }
            console.log('Toolbar clicked:', this.querySelector('i').className);
        });
    });

    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'w') {
            e.preventDefault();
            closeModal();
        }
        if (e.key === 'Escape') {
            closeModal();
        }
    });

    document.querySelector('.taskbar-windows').addEventListener('click', function() {
        if (window.windowsSounds && !soundsMuted) {
            window.windowsSounds.playClickSound();
        }
        document.querySelector('.file-explorer').style.zIndex = '1001';
        setTimeout(() => {
            document.querySelector('.file-explorer').style.zIndex = '10';
        }, 100);
    });

    const soundToggle = document.getElementById('soundToggle');
    
    soundToggle.addEventListener('click', function() {
        soundsMuted = !soundsMuted;
        if (soundsMuted) {
            this.textContent = 'ðŸ”‡';
            this.classList.add('muted');
            this.title = 'Enable Sounds';
        } else {
            this.textContent = 'ðŸ”Š';
            this.classList.remove('muted');
            this.title = 'Disable Sounds';
            if (window.windowsSounds) {
                window.windowsSounds.playClickSound();
            }
        }
    });
}

function openFile(fileName, folderName) {
    const fileData = portfolioContent[folderName]?.[fileName];
    if (fileData) {
        modalTitle.textContent = fileData.title;
        
        if (fileName.endsWith('.pdf')) {
            openPdfFile(fileData);
        } else {
            modalBody.innerHTML = `<div class="file-content">${fileData.content}</div>`;
        }
        
        if (window.windowsSounds && !soundsMuted) {
            window.windowsSounds.playFileOpenSound();
        }
        
        modal.style.display = 'block';
    }
}

function openPdfFile(fileData) {
    modalBody.innerHTML = `
        <div class="pdf-container">
            <div class="pdf-toolbar">
                <button class="pdf-download-btn" onclick="downloadPdf()">
                    <i class="fas fa-download"></i> Download PDF
                </button>
                <button class="pdf-zoom-btn" onclick="zoomPdf('in')">
                    <i class="fas fa-search-plus"></i>
                </button>
                <button class="pdf-zoom-btn" onclick="zoomPdf('out')">
                    <i class="fas fa-search-minus"></i>
                </button>
            </div>
            <div class="pdf-viewer" id="pdfViewer">
                <div class="pdf-loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    Loading PDF...
                </div>
            </div>
        </div>
    `;
    
    loadPdfContent(fileData.pdfUrl || 'path/to/your/resume.pdf');
}

let currentPdfZoom = 1.0;

function loadPdfContent(pdfUrl) {
    const pdfViewer = document.getElementById('pdfViewer');
    
    pdfjsLib.getDocument(pdfUrl).promise.then(function(pdf) {
        pdf.getPage(1).then(function(page) {
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            const viewport = page.getViewport({scale: currentPdfZoom});
            
            canvas.height = viewport.height;
            canvas.width = viewport.width;
            
            const renderContext = {
                canvasContext: context,
                viewport: viewport
            };
            
            page.render(renderContext).promise.then(function() {
                pdfViewer.innerHTML = '';
                pdfViewer.appendChild(canvas);
            });
        });
    }).catch(function(error) {
        pdfViewer.innerHTML = `
            <div class="pdf-error">
                <i class="fas fa-exclamation-triangle"></i>
                <p>Could not load PDF. Please check the file path.</p>
                <p>Error: ${error.message}</p>
            </div>
        `;
    });
}

function downloadPdf() {
    const link = document.createElement('a');
    link.href = 'path/to/your/resume.pdf';
    link.download = 'resume.pdf';
    link.click();
}

function zoomPdf(direction) {
    if (direction === 'in') {
        currentPdfZoom = Math.min(currentPdfZoom * 1.2, 3.0);
    } else {
        currentPdfZoom = Math.max(currentPdfZoom / 1.2, 0.5);
    }
    
    const pdfViewer = document.getElementById('pdfViewer');
    if (pdfViewer.querySelector('canvas')) {
        loadPdfContent('path/to/your/resume.pdf');
    }
}

function closeModal() {
    modal.style.display = 'none';
}

function selectFolder(folderName) {
    folderItems.forEach(item => {
        item.classList.remove('active');
        const icon = item.querySelector('i');
        icon.className = 'fas fa-folder';
    });
    
    const selectedFolder = document.querySelector(`[data-folder="${folderName}"]`);
    if (selectedFolder) {
        selectedFolder.classList.add('active');
        const icon = selectedFolder.querySelector('i');
        icon.className = 'fas fa-folder-open';
    }
    
    const addressInput = document.querySelector('.address-input');
    if (folderName === 'portfolio') {
        addressInput.textContent = 'C:\\CalvinJagare\\Portfolio\\';
    } else {
        addressInput.textContent = `C:\\CalvinJagare\\Portfolio\\${folderName}\\`;
    }
    
    loadFolderContents(folderName);
    
    updateStatusBar();
}

function loadFolderContents(folderName) {
    const fileList = document.getElementById('fileList');
    fileList.innerHTML = '';
    
    if (folderName === 'portfolio') {
        const subFolders = ['about', 'projects', 'skills', 'experience', 'contact'];
        subFolders.forEach(subFolder => {
            const folderItem = document.createElement('div');
            folderItem.className = 'file-item folder-display';
            folderItem.setAttribute('data-folder', subFolder);
            
            folderItem.innerHTML = `
                <i class="fas fa-folder"></i>
                <span>${subFolder.charAt(0).toUpperCase() + subFolder.slice(1)}/</span>
            `;
            
            folderItem.addEventListener('click', function() {
                if (window.windowsSounds && !soundsMuted) {
                    window.windowsSounds.playClickSound();
                }
                selectFolder(subFolder);
            });
            
            folderItem.addEventListener('dblclick', function() {
                if (window.windowsSounds && !soundsMuted) {
                    window.windowsSounds.playClickSound();
                }
                selectFolder(subFolder);
            });
            
            fileList.appendChild(folderItem);
        });
        
        if (portfolioContent[folderName]) {
            const files = portfolioContent[folderName];
            Object.keys(files).forEach(fileName => {
                const fileData = files[fileName];
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.setAttribute('data-file', fileName);
                fileItem.setAttribute('data-folder', folderName);
                
                // Determine icon based on file extension
                let iconClass = 'fas fa-file-alt';
                if (fileName.endsWith('.html')) {
                    iconClass = 'fas fa-file-code';
                } else if (fileName.endsWith('.pdf')) {
                    iconClass = 'fas fa-file-pdf';
                } else if (fileName.endsWith('.txt')) {
                    iconClass = 'fas fa-file-alt';
                }
                
                fileItem.innerHTML = `
                    <i class="${iconClass}"></i>
                    <span>${fileName}</span>
                `;
                
                // Add click event
                fileItem.addEventListener('click', function() {
                    if (window.windowsSounds && !soundsMuted) {
                        window.windowsSounds.playClickSound();
                    }
                    openFile(fileName, folderName);
                });
                
                fileItem.addEventListener('dblclick', function() {
                    if (window.windowsSounds && !soundsMuted) {
                        window.windowsSounds.playClickSound();
                    }
                    openFile(fileName, folderName);
                });
                
                fileList.appendChild(fileItem);
            });
        }
    } else {
        if (portfolioContent[folderName]) {
            const files = portfolioContent[folderName];
            Object.keys(files).forEach(fileName => {
                const fileData = files[fileName];
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.setAttribute('data-file', fileName);
                fileItem.setAttribute('data-folder', folderName);
                
                // Determine icon based on file extension
                let iconClass = 'fas fa-file-alt';
                if (fileName.endsWith('.html')) {
                    iconClass = 'fas fa-file-code';
                } else if (fileName.endsWith('.pdf')) {
                    iconClass = 'fas fa-file-pdf';
                } else if (fileName.endsWith('.txt')) {
                    iconClass = 'fas fa-file-alt';
                }
                
                fileItem.innerHTML = `
                    <i class="${iconClass}"></i>
                    <span>${fileName}</span>
                `;
                
                // Add click event
                fileItem.addEventListener('click', function() {
                    if (window.windowsSounds && !soundsMuted) {
                        window.windowsSounds.playClickSound();
                    }
                    openFile(fileName, folderName);
                });
                
                fileItem.addEventListener('dblclick', function() {
                    if (window.windowsSounds && !soundsMuted) {
                        window.windowsSounds.playClickSound();
                    }
                    openFile(fileName, folderName);
                });
                
                fileList.appendChild(fileItem);
            });
        }
    }
}

function updateStatusBar() {
    const fileList = document.getElementById('fileList');
    const fileCount = fileList.children.length;
    document.querySelector('.status-left').textContent = `${fileCount} objects`;
}

function updateTaskbarTime() {
    const now = new Date();
    const timeString = now.toLocaleTimeString('en-US', {
        hour: 'numeric',
        minute: '2-digit',
        hour12: true
    });
    const taskbarTime = document.getElementById('taskbarTime');
    if (taskbarTime) {
        taskbarTime.textContent = timeString;
    }
}

function startDragging(e) {
    initialX = e.clientX - xOffset;
    initialY = e.clientY - yOffset;
    
    if (e.target === titleBar) {
        isDragging = true;
    }
}

function drag(e) {
    if (isDragging) {
        e.preventDefault();
        
        currentX = e.clientX - initialX;
        currentY = e.clientY - initialY;
        
        xOffset = currentX;
        yOffset = currentY;
        
        setTranslate(currentX, currentY, document.querySelector('.file-explorer'));
    }
}

function stopDragging() {
    initialX = currentX;
    initialY = currentY;
    isDragging = false;
}

function setTranslate(xPos, yPos, el) {
    el.style.transform = `translate3d(${xPos}px, ${yPos}px, 0)`;
}

const style = document.createElement('style');
style.textContent = `
    @keyframes modalOpen {
        from {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
        }
        to {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }
    }
    
    .file-item {
        transition: all 0.2s ease;
    }
    
    .file-item:active {
        transform: scale(0.95);
    }
    
    .title-bar-button {
        transition: all 0.1s ease;
    }
    
    .toolbar-button {
        transition: all 0.1s ease;
    }
`;
document.head.appendChild(style);

function addNostalgicFeatures() {
    document.addEventListener('contextmenu', function(e) {
        e.preventDefault();
    });
    
    fileItems.forEach(item => {
        item.addEventListener('mousedown', function(e) {
            if (e.ctrlKey) {
                this.classList.toggle('selected');
            } else {
                fileItems.forEach(fi => fi.classList.remove('selected'));
                this.classList.add('selected');
            }
        });
    });
}

addNostalgicFeatures();

let clickCount = 0;
document.querySelector('.title-bar-icon').addEventListener('click', function() {
    clickCount++;
    if (clickCount >= 5) {
        alert('ðŸŽ‰ You found the Easter egg! Classic Windows nostalgia! ðŸŽ‰');
        clickCount = 0;
    }
}); 